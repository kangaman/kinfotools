<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NawaSec Scan Report - v1.1</title>
    <style>
        :root { --bg: #0f172a; --card: #1e293b; --text: #e2e8f0; --accent: #38bdf8; --border: #334155; --success: #22c55e; --danger: #ef4444; --warning: #f59e0b; }
        body { font-family: 'Segoe UI', system-ui, sans-serif; background: var(--bg); color: var(--text); margin: 0; padding: 20px; line-height: 1.6; }
        .container { max-width: 1200px; margin: 0 auto; }
        header { text-align: center; padding: 40px 0; border-bottom: 1px solid var(--border); margin-bottom: 40px; }
        h1 { color: var(--accent); font-size: 2.5rem; margin: 0; display: flex; align-items: center; justify-content: center; gap: 15px; }
        .meta { color: #94a3b8; margin-top: 10px; font-size: 0.9rem; }
        .card { background: var(--card); border-radius: 12px; padding: 25px; margin-bottom: 25px; border: 1px solid var(--border); box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1); }
        h2 { color: var(--accent); border-bottom: 2px solid var(--border); padding-bottom: 10px; margin-top: 0; font-size: 1.5rem; }
        pre { background: #020617; padding: 15px; border-radius: 8px; overflow-x: auto; color: #a5b4fc; font-family: 'Consolas', monospace; font-size: 0.85rem; }
        
        /* Table Styles */
        .res-table { width: 100%; border-collapse: separate; border-spacing: 0; margin-top: 15px; }
        .res-table th { background: #0f172a; color: var(--accent); padding: 12px; text-align: left; border-bottom: 2px solid var(--border); position: sticky; top: 0; }
        .res-table td { padding: 12px; border-bottom: 1px solid var(--border); font-size: 0.95rem; }
        .res-table tr:hover td { background: rgba(56, 189, 248, 0.05); }
        
        /* Badges */
        .badge { display: inline-block; padding: 4px 10px; border-radius: 999px; font-size: 0.75rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.5px; }
        .badge-live { background: rgba(239, 68, 68, 0.2); color: #fca5a5; border: 1px solid rgba(239, 68, 68, 0.4); } /* Merah */
        .badge-ghost { background: rgba(148, 163, 184, 0.2); color: #cbd5e1; border: 1px solid rgba(148, 163, 184, 0.4); } /* Abu */
        .badge-clean { background: rgba(34, 197, 94, 0.2); color: #86efac; border: 1px solid rgba(34, 197, 94, 0.4); } /* Hijau */
        
        /* Utilities */
        .url-link { color: var(--accent); text-decoration: none; transition: all 0.2s; }
        .url-link:hover { color: #7dd3fc; text-decoration: underline; }
        .stat-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-top: 20px; }
        .stat-box { background: #0f172a; padding: 20px; border-radius: 10px; text-align: center; border: 1px solid var(--border); }
        .stat-num { font-size: 2.5rem; font-weight: 800; line-height: 1; margin-bottom: 5px; color: var(--text); }
        .stat-label { color: #94a3b8; font-size: 0.85rem; text-transform: uppercase; letter-spacing: 1px; }

        .footer { text-align: center; margin-top: 50px; color: #64748b; font-size: 0.9em; border-top: 1px solid var(--border); padding-top: 20px; }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üõ°Ô∏è NawaSec Scan Report</h1>
            <div class="meta">Generated by NawaSec Framework v1.1 | Sat Jan 10 00:57:17 WIB 2026 | Target Scope: <span id="targetScope">Detecting...</span></div>
        </header>

        <!-- Summary Section -->
        <div class="card">
            <h2>üìä Executive Summary</h2>
            <div id="statsContainer" class="stat-grid">Loading stats...</div>
        </div>

        <!-- Detailed Results Section -->
        <div class="card">
            <h2>üìù Detailed Findings</h2>
            <div id="resultsContainer">Initializing data table...</div>
        </div>
        
        <!-- Raw Data (Hidden by default, toggleable) -->
        <div class="card">
            <h2 style="cursor: pointer;" onclick="document.getElementById('rawData').style.display = document.getElementById('rawData').style.display === 'none' ? 'block' : 'none'">‚öôÔ∏è Raw Data (Click to Toggle)</h2>
            <pre id="rawData" style="display:none;"></pre>
        </div>

        <div class="footer">NawaSec Framework - Ultimate Edition | Secure Channel</div>
    </div>

    <script>
        // Inject Data safely
        const rawData = `{
  "target": "mahkotagraha54.my.id",
  "results": [
    {
      "status": "[open]",
      "type": "PORT (tcp)",
      "url": "mahkotagraha54.my.id:25",
      "info": "tcpwrapped"
    },
    {
      "status": "[open]",
      "type": "PORT (tcp)",
      "url": "mahkotagraha54.my.id:443",
      "info": "tcpwrapped"
    },
    {
      "status": "[open]",
      "type": "PORT (tcp)",
      "url": "mahkotagraha54.my.id:995",
      "info": "tcpwrapped"
    }
  ]
}`;
        let data = {};

        try {
            data = JSON.parse(rawData);
            document.getElementById('rawData').textContent = JSON.stringify(data, null, 2);
            document.getElementById('targetScope').textContent = data.target || "Unknown Target";
            
            renderDashboard(data);
        } catch (e) {
            console.error("JSON Parse Error:", e);
            document.getElementById('resultsContainer').innerHTML = '<div style="color:var(--danger); padding:20px; text-align:center;">‚ùå Error parsing scan data. Raw output might be corrupted.<br><small>'+e.message+'</small></div>';
            document.getElementById('rawData').textContent = rawData; // Show raw text if parse fails
            document.getElementById('rawData').style.display = 'block';
        }

        function renderDashboard(data) {
            // 1. STATS
            let statsHtml = '';
            let results = data.results || [];
            
            // Hitung statistik sederhana
            let total = results.length;
            let live = results.filter(r => r.status && r.status.includes('LIVE') || r.status.includes('!!!')).length;
            let ghost = results.filter(r => r.status && r.status.includes('GHOST')).length;
            let others = total - live - ghost;

            if (total > 0) {
                statsHtml += createStatBox(total, 'Total Findings', '#38bdf8');
                if (live > 0) statsHtml += createStatBox(live, 'Critical / Live', '#ef4444');
                if (ghost > 0) statsHtml += createStatBox(ghost, 'Ghost / Dead', '#94a3b8');
            } else {
                 // Jika data generik (bukan array results)
                 let keyCount = Object.keys(data).length;
                 statsHtml += createStatBox(keyCount, 'Data Fields', '#38bdf8');
            }
            document.getElementById('statsContainer').innerHTML = statsHtml;

            // 2. DETAILED TABLE
            if (results && results.length > 0) {
                let tableHtml = '<div style="overflow-x:auto;"><table class="res-table"><thead><tr>';
                
                // Deteksi kolom secara dinamis dari item pertama
                let headers = Object.keys(results[0]);
                // Prioritaskan kolom tertentu agar urutannya bagus
                const priority = ['status', 'type', 'url', 'file', 'info', 'size', 'keyword'];
                headers.sort((a, b) => {
                    let ia = priority.indexOf(a); let ib = priority.indexOf(b);
                    if (ia === -1) ia = 99; if (ib === -1) ib = 99;
                    return ia - ib;
                });

                headers.forEach(h => {
                    tableHtml += `<th>${h.toUpperCase()}</th>`;
                });
                tableHtml += '</tr></thead><tbody>';

                results.forEach(row => {
                    tableHtml += '<tr>';
                    headers.forEach(key => {
                        let val = row[key] || '-';
                        tableHtml += `<td>${formatValue(key, val)}</td>`;
                    });
                    tableHtml += '</tr>';
                });
                tableHtml += '</tbody></table></div>';
                document.getElementById('resultsContainer').innerHTML = tableHtml;
            } else {
                // Fallback untuk data Key-Value (non-array)
                let kvHtml = '<table class="res-table">';
                for (const [key, value] of Object.entries(data)) {
                    if (typeof value !== 'object') {
                        kvHtml += `<tr><th width="200">${key}</th><td>${value}</td></tr>`;
                    }
                }
                kvHtml += '</table>';
                document.getElementById('resultsContainer').innerHTML = kvHtml;
            }
        }

        function createStatBox(num, label, color) {
            return `<div class="stat-box" style="border-top: 4px solid ${color}">
                <div class="stat-num" style="color: ${color}">${num}</div>
                <div class="stat-label">${label}</div>
            </div>`;
        }

        function formatValue(key, val) {
            if (key === 'url' || key === 'link') {
                return `<a href="${val}" target="_blank" class="url-link">${val}</a>`;
            }
            if (key === 'status') {
                if (val.includes('LIVE') || val.includes('!!!')) return `<span class="badge badge-live">${val}</span>`;
                if (val.includes('GHOST') || val.includes('404')) return `<span class="badge badge-ghost">${val}</span>`;
                if (val.includes('CLEAN')) return `<span class="badge badge-clean">${val}</span>`;
            }
            return val;
        }
    </script>
</body>
</html>
